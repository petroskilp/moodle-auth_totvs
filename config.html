<?php
global $OUTPUT;
// set to defaults if undefined
if (!isset($config->protocol)) {
    $config->protocol = 'soap';
}
if (!isset($config->auth_serverurl)) {
    $config->auth_serverurl  = '';
}
if (!isset($config->default_params)) {
    $config->default_params = '';
}
if (!isset($config->auth_function)) {
    $config->auth_function = '';
}
if (!isset($config->auth_function_username_paramname)) {
    $config->auth_function_username_paramname = '';
}
if (!isset($config->auth_function_password_paramname)) {
    $config->auth_function_password_paramname = '';
}
if (!isset($config->auth_function_resultClass)) {
    $config->auth_function_resultClass = '';
}
if (!isset($config->auth_function_resultField)) {
    $config->auth_function_resultField = '';
}
if (!isset($config->removeuser)) {
    $config->removeuser = AUTH_REMOVEUSER_KEEP;
}
if (!isset($config->changepasswordurl)) {
    $config->changepasswordurl = '';
}
?>
<table cellspacing="0" cellpadding="5" border="0">

<tr valign="top" class="required">
    <td align="right"><label for="protocol"><?php print_string("protocol", "auth_ws") ?></label></td>
    <td>
        <p id="protocol">SOAP</p>
    </td>
    <td><?php print_string("protocol_desc", "auth_ws") ?></td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="auth_serverurl"><?php print_string("auth_serverurl", "auth_ws") ?></label></td>
    <td>
        <input id="auth_serverurl" name="auth_serverurl" type="text" size="50" value="<?php echo $config->auth_serverurl; ?>" />
        <?php
        if (isset($err["auth_serverurl"])) {
            echo $OUTPUT->error_text($err["auth_serverurl"]);
        }
        ?>
    </td>
    <td><?php print_string("auth_serverurl_desc", "auth_ws") ?></td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="default_params"><?php print_string("default_params", "auth_ws") ?></label></td>
    <td>
        <input id="default_params" name="default_params" type="text" size="50" value="<?php echo $config->default_params; ?>" />
        <?php
        if (isset($err["default_params"])) {
            echo $OUTPUT->error_text($err["default_params"]);
        }
        ?>
    </td>
    <td><?php print_string("default_params_desc", "auth_ws") ?></td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="auth_function"><?php print_string("auth_function", "auth_ws") ?></label></td>
    <td>
        <input id="auth_function" name="auth_function" type="text" size="50" value="<?php p($config->auth_function)?>" autocomplete="off"/>
        <?php

        if (isset($err["auth_function"])) {
            echo $OUTPUT->error_text($err["auth_function"]);
        }

        ?>
    </td>
    <td>
    <?php print_string("auth_function_desc", "auth_ws") ?>
    </td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="auth_function_username_paramname"><?php print_string("auth_function_username_paramname", "auth_ws") ?></label></td>
    <td>
        <input id="auth_function_username_paramname" name="auth_function_username_paramname" type="text" size="50" value="<?php p($config->auth_function_username_paramname)?>" autocomplete="off"/>
        <?php

        if (isset($err["auth_function_username_paramname"])) {
            echo $OUTPUT->error_text($err["auth_function_username_paramname"]);
        }

        ?>
    </td>
    <td>
    <?php print_string("auth_function_username_paramname_desc", "auth_ws") ?>
    </td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="auth_function_password_paramname"><?php print_string("auth_function_password_paramname", "auth_ws") ?></label></td>
    <td>
        <input id="auth_function_password_paramname" name="auth_function_password_paramname" type="text" size="50" value="<?php p($config->auth_function_password_paramname)?>" autocomplete="off"/>
        <?php

        if (isset($err["auth_function_password_paramname"])) {
            echo $OUTPUT->error_text($err["auth_function_password_paramname"]);
        }

        ?>
    </td>
    <td>
    <?php print_string("auth_function_password_paramname_desc", "auth_ws") ?>
    </td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="auth_function_resultClass"><?php print_string("auth_function_resultClass", "auth_ws") ?></label></td>
    <td>
        <input id="auth_function_resultClass" name="auth_function_resultClass" type="text" size="50" value="<?php p($config->auth_function_resultClass)?>" autocomplete="off"/>
        <?php

        if (isset($err["auth_function_resultClass"])) {
            echo $OUTPUT->error_text($err["auth_function_resultClass"]);
        }

        ?>
    </td>
    <td>
    <?php print_string("auth_function_resultClass_desc", "auth_ws") ?>
    </td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="auth_function_resultField"><?php print_string("auth_function_resultField", "auth_ws") ?></label></td>
    <td>
        <input id="auth_function_resultField" name="auth_function_resultField" type="text" size="50" value="<?php p($config->auth_function_resultField)?>" autocomplete="off"/>
        <?php

        if (isset($err["auth_function_resultField"])) {
            echo $OUTPUT->error_text($err["auth_function_resultField"]);
        }

        ?>
    </td>
    <td>
    <?php print_string("auth_function_resultField_desc", "auth_ws") ?>
    </td>
</tr>

<tr valign="top">
    <td align="right"><label for="menuremoveuser"><?php print_string('auth_remove_user_key','auth') ?></label></td>
    <td>
    <?php
       $deleteopt = array();
       $deleteopt[AUTH_REMOVEUSER_KEEP] = get_string('auth_remove_keep','auth');
       $deleteopt[AUTH_REMOVEUSER_SUSPEND] = get_string('auth_remove_suspend','auth');
       $deleteopt[AUTH_REMOVEUSER_FULLDELETE] = get_string('auth_remove_delete','auth');
       echo html_writer::select($deleteopt, 'removeuser', $config->removeuser, false);
    ?>
    </td>
    <td>
    <?php print_string('auth_remove_user','auth') ?>
    </td>
</tr>

<tr valign="top">
    <td align="right"><label for="changepasswordurl"><?php print_string("changepasswordurl", "auth_ws") ?></label></td>
    <td>
        <input id="changepasswordurl" name="changepasswordurl" type="text" value="<?php echo $config->changepasswordurl ?>" />
        <?php

        if (isset($err['changepasswordurl'])) {
            echo $OUTPUT->error_text($err['changepasswordurl']);
        }

        ?>
    </td>
    <td><?php print_string('changepasswordhelp', 'auth') ?></td>
</tr>

<?php
print_auth_lock_options($this->authtype, $userfields, '', false, true);
?>
</table>
